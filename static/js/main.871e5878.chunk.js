(this.webpackJsonpbiskeytool=this.webpackJsonpbiskeytool||[]).push([[0],{20:function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return p}));var s=n(29),i=n.n(s),r=new Uint8Array([223,32,111,89,68,84,239,220,112,116,72,59,13,237,159,211]),c=new Uint8Array([79,2,95,14,182,109,17,14,220,50,125,65,134,194,244,120]),a=new Uint8Array([226,214,184,122,17,156,184,128,232,34,136,138,70,251,161,149]),l=new Uint8Array([77,135,9,134,196,93,32,114,47,186,16,83,218,146,232,169]),o=new Uint8Array([137,97,94,224,92,49,182,128,95,229,143,61,162,79,122,168]),u=new Uint8Array([52,193,160,196,130,88,248,180,250,158,94,106,218,252,126,79]),d=new Uint8Array([248,63,56,110,44,210,202,50,168,154,185,170,41,191,199,72,125,146,176,58,168,191,222,225,167,76,59,110,53,203,113,6]),h=new Uint8Array([65,0,48,73,221,204,192,101,100,122,126,180,30,237,156,95,68,66,78,218,180,157,252,217,135,119,36,154,220,159,124,164]),y=new Uint8Array([82,194,233,235,9,227,238,41,50,161,12,31,182,160,146,108,77,18,225,75,42,71,76,28,9,203,3,89,240,21,244,228]);function b(e){return Array.from(e,(function(e){return("0"+(255&e).toString(16)).slice(-2)})).join("").toUpperCase()}function j(t){return e.from(t,"hex")}function f(e,t){var n=[],s=b(e).substring(0,32),i=b(e).substring(32);return n.push("BIS Key ".concat(t," (Crypt): ").concat(s)),n.push("BIS Key ".concat(t," (Tweak): ").concat(i)),n}function v(e,t){return new i.a(t,"ecb").decrypt(e,128)}function p(e,t){var n=[];"string"===typeof e&&(e=j(e)),"string"===typeof t&&(t=j(t));var s=v(r,t),i=v(s,e),p=v(c,i),m=v(a,p),O=v(d,m),k=v(l,p),x=v(u,k),w=v(o,x),g=v(h,w),S=v(y,w);return n.push("SBK Key: "+b(e)),n.push("TSEC Key: "+b(t)),n=(n=(n=(n=n.concat(f(O,0))).concat(f(g,1))).concat(f(S,2))).concat(f(S,3))}}).call(this,n(41).Buffer)},39:function(e,t,n){},40:function(e,t,n){},58:function(e,t,n){"use strict";n.r(t);var s=n(0),i=n.n(s),r=n(10),c=n.n(r),a=(n(39),n(40),n(26)),l=n(27),o=n(33),u=n(32),d=n(28),h=n.n(d),y=n(64),b=n(61),j=n(63),f=n(62),v=n(20),p=n(5),m=function(e){Object(o.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(a.a)(this,n),(s=t.call(this,e)).state={results:[]},s}return Object(l.a)(n,[{key:"componentDidMount",value:function(){h.a.init()}},{key:"deriveFromFile",value:function(){var e=this,t=document.getElementById("file-fuse-cached").files[0],n=document.getElementById("file-tsec-keys").files[0],s=[];t&&n&&(768!==t.size&&s.push("Uploaded fuse_cached.bin is not the correct size."),32!==n.size&&s.push("Uploaded tsec_keys.bin is not the correct size."),s.length>0?this.showResults(s):Promise.all([t.arrayBuffer(),n.arrayBuffer()]).then((function(t){var n,i=new Uint8Array(t[0]),r=new Uint8Array(t[1]);if(131!==i[16]&&s.push("Your fuse_cached.bin is not valid."),s.length>0)e.showResults(s);else{var c=i.slice(164,180),a=r.slice(0,16);n=Object(v.a)(c,a),e.showResults(n)}})))}},{key:"deriveFromKeys",value:function(){var e=["a","b","c","d","e","f","A","B","C","D","E","F","0","1","2","3","4","5","6","7","8","9"],t=[],n=document.getElementById("key-sbk").value,s=document.getElementById("key-tsec").value;32!==n.length&&t.push("SBK key length is not valid."),32!==s.length&&t.push("TSEC key length is not valid."),n.split("").every((function(n){return e.includes(n)||t.push("SBK key contains invalid characters."),e.includes(n)})),s.split("").every((function(n){return e.includes(n)||t.push("TSEC key contains invalid characters."),e.includes(n)})),t.length>0||(t=Object(v.a)(n,s)),this.showResults(t)}},{key:"showResults",value:function(e){this.setState({results:e})}},{key:"render",value:function(){var e=this,t=this.state.results.join("\n");return Object(p.jsxs)("div",{children:[Object(p.jsxs)("div",{className:"center",children:[Object(p.jsx)("h1",{className:"tall-margin",children:"BIS Key Calculator"}),Object(p.jsx)("div",{children:"Key deriver based on an implementation by Simon."}),Object(p.jsx)("div",{children:"All operations are performed within your browser. No key data is ever sent to a server."}),Object(p.jsx)("div",{children:"You can calculate your BIS keys below by either uploading a couple Hekate dumps, or by entering your SBK and TSEC keys manually."})]}),Object(p.jsxs)("div",{className:"bis-box",children:[Object(p.jsxs)(y.a,{defaultActiveKey:"bis-files",children:[Object(p.jsxs)(b.a,{eventKey:"bis-files",title:"Upload Dumps",children:[Object(p.jsxs)(j.a,{children:[Object(p.jsx)("h6",{children:"Upload Hekate fuse_cached.bin"}),Object(p.jsx)(j.a.File,{id:"file-fuse-cached",label:"No file selected",custom:!0}),Object(p.jsx)("h6",{children:"Upload Hekate tsec_keys.bin"}),Object(p.jsx)(j.a.File,{id:"file-tsec-keys",label:"No file selected",custom:!0})]}),Object(p.jsx)("br",{}),Object(p.jsx)(f.a,{variant:"danger",onClick:function(){e.deriveFromFile()},className:"btn-wide",children:"Derive BIS keys from files"})]}),Object(p.jsxs)(b.a,{eventKey:"bis-text",title:"Enter Keys",children:[Object(p.jsxs)(j.a,{children:[Object(p.jsx)("h6",{children:"Enter SBK Key"}),Object(p.jsx)(j.a.Control,{id:"key-sbk",placeholder:"00000000000000000000000000000000"}),Object(p.jsx)("h6",{children:"Enter TSEC Key"}),Object(p.jsx)(j.a.Control,{id:"key-tsec",placeholder:"00000000000000000000000000000000"})]}),Object(p.jsx)("br",{}),Object(p.jsx)(f.a,{variant:"danger",onClick:function(){e.deriveFromKeys()},className:"btn-wide",children:"Derive BIS keys from SBK/TSEC keys"})]})]}),Object(p.jsx)(j.a.Control,{as:"textarea",rows:10,readOnly:!0,value:t})]})]})}}]),n}(i.a.Component);var O=function(){return Object(p.jsx)("div",{className:"App",children:Object(p.jsx)(m,{})})};c.a.render(Object(p.jsx)(i.a.StrictMode,{children:Object(p.jsx)(O,{})}),document.getElementById("root"))}},[[58,1,2]]]);
//# sourceMappingURL=main.871e5878.chunk.js.map